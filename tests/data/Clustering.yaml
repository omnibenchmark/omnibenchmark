id: clustering_benchmark
description: Clustering benchmark on Iris and Penguins Dataset.
version: "1.0"
benchmarker: "OmniBenchmark Team at Robinsons Lab"
api_version: "0.3.0"
storage: https://rgw.science-it.uzh.ch/
storage_api: S3
storage_bucket_name: omnibenchmark-remote-testing
software_backend: conda
software_environments:
  R:
    description: "R 4.4.1 with gfbf-2023 toolchain"
    easyconfig: R_4.4.1_Clustering.eb
    envmodule: R_4.4.1_Clustering.lua
    conda: envs/R_4.4.1_Clustering.yaml
    apptainer: http://registry.ch/R_4.3.3-gfbf-2023b.sif
  python:
    description: "Python 3.12.6"
    easyconfig: Python_3.12.6_Clustering.eb
    envmodule: Python_3.12.6_Clustering.lua
    conda: envs/Python_3.12.6_Clustering.yaml
    apptainer: http://registry.ch/python_vX-gfbf-2023b.sif
metric_collectors:
  - id: biometrics
    name: "Biologically-relevant performance metrics gathering and postprocessing."
    software_environment: "python"
    repository:
      url: https://github.com/omnibenchmark-example/metric-collector.git
      commit: 31e592d
    inputs:
      - id: metrics.mapping
        path: "{dataset}.mapping.json"
    outputs:
      - id: biometrics_report.html
        path: "biometrics_report.html"
      - id: biometrics.tsv
        path: "biometrics.tsv"
stages:
  - id: data
    modules:
      - id: iris
        name: "Iris Dataset"
        software_environment: "python"
        repository:
          url: https://github.com/omnibenchmark-example/iris.git
          commit: 78d23a0
      - id: penguins
        name: "Penguins Dataset"
        software_environment: "python"
        repository:
          url: https://github.com/omnibenchmark-example/penguins.git
          commit: "3e48199"
    outputs:
      - id: data.features
        path: "{dataset}.features.csv"
      - id: data.labels
        path: "{dataset}.labels.csv"

  - id: distances
    modules:
      - id: D1
        software_environment: "python"
        parameters:
          - measure: ["cosine", "euclidean", "manhattan", "chebyshev"]
        repository:
          url: https://github.com/omnibenchmark-example/distance.git
          commit: 649df9c
    inputs: [ data.features ]
    outputs:
      - id: distances
        path: "{dataset}.distances.csv"

  - id: methods
    modules:
      - id: kmeans
        software_environment: "python"
        repository:
          url: https://github.com/omnibenchmark-example/kmeans.git
          commit: 60cee11
      - id: ward
        software_environment: "R"
        repository:
          url: https://github.com/omnibenchmark-example/ward.git
          commit: f24dd42
    inputs: [ distances ]
    outputs:
      - id: methods.clusters
        path: "{dataset}.clusters.csv"

  - id: metrics
    modules:
      - id: ari
        software_environment: "R"
        repository:
          url: https://github.com/omnibenchmark-example/ari.git
          commit: 27c5f3f
      - id: accuracy
        software_environment: "R"
        repository:
          url: https://github.com/omnibenchmark-example/accuracy.git
          commit: 3fedcea
    inputs: [ methods.clusters, data.labels ]
    outputs:
      - id: metrics.mapping
        path: "{dataset}.metrics.txt"
