id: EnvmodulesBackendTest
description: Test benchmark for envmodules environment resolution
version: "1.0"
benchmarker: "Test Suite"
software_backend: envmodules

software_environments:
  - id: gcc_env
    description: "GCC compiler environment"
    envmodule: GCC/11.3.0
  
  - id: python_env
    description: "Python scientific stack"
    envmodule: Python/3.10.4-GCCcore-11.3.0

stages:
  - id: data
    modules:
      - id: loader
        name: "Data loader with GCC"
        software_environment: "gcc_env"
        repository:
          url: bundles/dummymodule_4ff8427.bundle
          commit: 4ff8427
        parameters:
          - evaluate: "1+1"
    outputs:
      - id: data.raw
        path: "{dataset}_data.json"

  - id: processing
    modules:
      - id: processor
        name: "Data processor with Python"
        software_environment: "python_env"
        repository:
          url: bundles/dummymodule_4ff8427.bundle
          commit: 4ff8427
        parameters:
          - evaluate: "input*2"
            input: "data.raw"
    inputs:
      - data.raw
    outputs:
      - id: processed.result
        path: "{dataset}_processed.json"